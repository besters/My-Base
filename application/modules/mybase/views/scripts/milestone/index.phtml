<div id="main">
   <div id="title">
      <div id="title-links">
         <?php if($this->acl($this->Param('projekt') . '|milestone', 'new')): ?>
                                                         <?=$this->ActionLink('/milestone/new', 'Create New Milestone', true); ?>
         <?php endif; ?>
               </div>
               <h2><?php echo $this->Translate('Milestones'); ?></h2>
            </div>
            <div id="obsah">
      <?php echo $this->flashMessages(); ?>
















<?php /**

            <table class="milestone active">
      	 <thead>
      	    <tr>
      	       <th colspan="2" class="active"><?php echo $this->Translate('Active'); ?> (<?php echo count($this->active); ?>)</th>
      	    </tr>
      	 </thead>
      	 <tbody>
      	    <?php
	    foreach($this->active as $milestone):
               $due = new Zend_Date($milestone->datetime);
               $now = new Zend_Date();

               $over = $now->compare($due); //0 = equal, 1 = later, -1 = earlier

	       $over == 1 ? $late = 'late' :  $late = '';

               $date = $due->get(Zend_Date::DATE_FULL, 'cs_CZ');

               $sub = $due->sub($now);

               $num = $sub->get(Zend_Date::TIMESTAMP) / 60 / 60 / 24;
            ?>
      	    <tr class="<?php echo ($i % 2 == 0 ? '' : 'even') ?> <?=$late;?>">
      	       <td class="name">
		  <div class="date <?=$late;?>">
		    <?php
                     echo $this->Translate(array('%s day', '%s days', $num), abs($num));
		     echo ' ';
		     echo $num >= 0 ? $this->Translate('away') : $this->Translate('ago');
		     echo ' (' . $date . ')';
		    ?>
		  </div>
      		  <a href="milestone/detail/<?php echo $milestone->idmilestone; ?>" class="title"><?php echo $milestone->name; ?></a>
      		  <p><strong><?php echo $this->Translate('Assigned to'); ?></strong>
		     <?php foreach($milestone->user as $numId => $user): ?>
		     <a href="/people/detail/<?php echo $milestone->iduser[$numId] ?>"><?php echo $user; ?></a>,
		     <?php endforeach; ?>
      		  </p>
      	       </td>
      	       <td class="status">status</td>
      	    </tr>
      	    <?php $i++;  endforeach; ?> 
      	 </tbody>
            </table>

*/ ?>











            <table class="milestone active">
      	 <thead>
      	    <tr>
      	       <th colspan="2" class="active"><?php echo $this->Translate('Active'); ?> (<?php echo count($this->active); ?>)</th>
      	    </tr>
      	 </thead>
      	 <tbody>
      	    <?php
	    $i = 0;
	    $now = new Zend_Date(null, 'MM.dd.yyyy');
	    foreach($this->active as $milestone):
               $due = new Zend_Date($milestone->datetime);               

               $over = $now->compare($due); //0 = equal, 1 = later, -1 = earlier

	       if($over == 1){
		  $late = 'late';
	       }elseif($over == 0){
		  $late = 'today';
	       }else{
		  $late = '';
	       }

               $date = $due->get(Zend_Date::DATE_FULL, 'cs_CZ');

               $sub = $due->sub($now);

               $num = ceil($sub->get(Zend_Date::TIMESTAMP) / 60 / 60 / 24);
            ?>
      	    <tr class="<?php echo ($i % 2 == 0 ? '' : 'even') ?> <?=$late;?>">
      	       <td class="name">
		  <div class="date <?=$late;?>">
		    <?php
		    
		       if(abs($num) == 0){
			  echo $this->Translate('Today');
		       }else{
			   echo $this->Translate(array('%s day', '%s days', $num), abs($num));
			   echo ' ';
			   echo $num > 0 ? $this->Translate('away') : $this->Translate('ago');  
		       }

		     echo ' (' . $date . ')';
		    ?>
		  </div>
      		  <a href="milestone/detail/<?php echo $milestone->idmilestone; ?>" class="title"><?php echo $milestone->name; ?></a>
      		  <p><strong><?php echo $this->Translate('Assigned to'); ?></strong>


		     <?php foreach($milestone->users as $user): ?>
			<a href="/people/detail/<?= $user->iduser ?>"><?= $user->name . ' ' . $user->surname; ?></a>,
		     <?php endforeach; ?>

		     
      		  </p>
      	       </td>
      	       <td class="status">status</td>
      	    </tr>
      	    <?php $i++;  endforeach; ?>
      	 </tbody>
            </table>


<table class="milestone paused">
      	 <thead>
      	    <tr>
      	       <th colspan="2" class="paused"><?php echo $this->Translate('Paused'); ?> (<?php echo count($this->paused); ?>)</th>
      	    </tr>
      	 </thead>
      	 <tbody>
      	    <?php
	    $i = 0;
	    $now = new Zend_Date(null, 'MM.dd.yyyy');
	    foreach($this->paused as $milestone):
               $due = new Zend_Date($milestone->datetime);

               $over = $now->compare($due); //0 = equal, 1 = later, -1 = earlier

	       if($over == 1){
		  $late = 'late';
	       }elseif($over == 0){
		  $late = 'today';
	       }else{
		  $late = '';
	       }

               $date = $due->get(Zend_Date::DATE_FULL, 'cs_CZ');

               $sub = $due->sub($now);

               $num = ceil($sub->get(Zend_Date::TIMESTAMP) / 60 / 60 / 24);
            ?>
      	    <tr class="<?php echo ($i % 2 == 0 ? '' : 'even') ?> <?=$late;?>">
      	       <td class="name">
		  <div class="date <?=$late;?>">
		    <?php

		       if(abs($num) == 0){
			  echo $this->Translate('Today');
		       }else{
			   echo $this->Translate(array('%s day', '%s days', $num), abs($num));
			   echo ' ';
			   echo $num > 0 ? $this->Translate('away') : $this->Translate('ago');
		       }

		     echo ' (' . $date . ')';
		    ?>
		  </div>
      		  <a href="milestone/detail/<?php echo $milestone->idmilestone; ?>" class="title"><?php echo $milestone->name; ?></a>
      		  <p><strong><?php echo $this->Translate('Assigned to'); ?></strong>


		     <?php foreach($milestone->users as $user): ?>
			<a href="/people/detail/<?= $user->iduser ?>"><?= $user->name . ' ' . $user->surname; ?></a>,
		     <?php endforeach; ?>


      		  </p>
      	       </td>
      	       <td class="status">status</td>
      	    </tr>
      	    <?php $i++;  endforeach; ?>
      	 </tbody>
            </table>


<table class="milestone complete">
      	 <thead>
      	    <tr>
      	       <th colspan="2" class="complete"><?php echo $this->Translate('Complete'); ?> (<?php echo count($this->complete); ?>)</th>
      	    </tr>
      	 </thead>
      	 <tbody>
      	    <?php
	    $i = 0;
	    $now = new Zend_Date(null, 'MM.dd.yyyy');
	    foreach($this->complete as $milestone):
               $due = new Zend_Date($milestone->datetime);

               $over = $now->compare($due); //0 = equal, 1 = later, -1 = earlier

	       if($over == 1){
		  $late = 'late';
	       }elseif($over == 0){
		  $late = 'today';
	       }else{
		  $late = '';
	       }

               $date = $due->get(Zend_Date::DATE_FULL, 'cs_CZ');

               $sub = $due->sub($now);

               $num = ceil($sub->get(Zend_Date::TIMESTAMP) / 60 / 60 / 24);
            ?>
      	    <tr class="<?php echo ($i % 2 == 0 ? '' : 'even') ?> <?=$late;?>">
      	       <td class="name">
		  <div class="date <?=$late;?>">
		    <?php

		       if(abs($num) == 0){
			  echo $this->Translate('Today');
		       }else{
			   echo $this->Translate(array('%s day', '%s days', $num), abs($num));
			   echo ' ';
			   echo $num > 0 ? $this->Translate('away') : $this->Translate('ago');
		       }

		     echo ' (' . $date . ')';
		    ?>
		  </div>
      		  <a href="milestone/detail/<?php echo $milestone->idmilestone; ?>" class="title"><?php echo $milestone->name; ?></a>
      		  <p><strong><?php echo $this->Translate('Assigned to'); ?></strong>


		     <?php foreach($milestone->users as $user): ?>
			<a href="/people/detail/<?= $user->iduser ?>"><?= $user->name . ' ' . $user->surname; ?></a>,
		     <?php endforeach; ?>


      		  </p>
      	       </td>
      	       <td class="status">status</td>
      	    </tr>
      	    <?php $i++;  endforeach; ?>
      	 </tbody>
            </table>


<table class="milestone canceled">
      	 <thead>
      	    <tr>
      	       <th colspan="2" class="canceled"><?php echo $this->Translate('Canceled'); ?> (<?php echo count($this->canceled); ?>)</th>
      	    </tr>
      	 </thead>
      	 <tbody>
      	    <?php
	    $i = 0;
	    $now = new Zend_Date(null, 'MM.dd.yyyy');
	    foreach($this->canceled as $milestone):
               $due = new Zend_Date($milestone->datetime);

               $over = $now->compare($due); //0 = equal, 1 = later, -1 = earlier

	       if($over == 1){
		  $late = 'late';
	       }elseif($over == 0){
		  $late = 'today';
	       }else{
		  $late = '';
	       }

               $date = $due->get(Zend_Date::DATE_FULL, 'cs_CZ');

               $sub = $due->sub($now);

               $num = ceil($sub->get(Zend_Date::TIMESTAMP) / 60 / 60 / 24);
            ?>
      	    <tr class="<?php echo ($i % 2 == 0 ? '' : 'even') ?> <?=$late;?>">
      	       <td class="name">
		  <div class="date <?=$late;?>">
		    <?php

		       if(abs($num) == 0){
			  echo $this->Translate('Today');
		       }else{
			   echo $this->Translate(array('%s day', '%s days', $num), abs($num));
			   echo ' ';
			   echo $num > 0 ? $this->Translate('away') : $this->Translate('ago');
		       }

		     echo ' (' . $date . ')';
		    ?>
		  </div>
      		  <a href="milestone/detail/<?php echo $milestone->idmilestone; ?>" class="title"><?php echo $milestone->name; ?></a>
      		  <p><strong><?php echo $this->Translate('Assigned to'); ?></strong>


		     <?php foreach($milestone->users as $user): ?>
			<a href="/people/detail/<?= $user->iduser ?>"><?= $user->name . ' ' . $user->surname; ?></a>,
		     <?php endforeach; ?>


      		  </p>
      	       </td>
      	       <td class="status">status</td>
      	    </tr>
      	    <?php $i++;  endforeach; ?>
      	 </tbody>
            </table>





      <br class="clear" />


   </div>
</div>